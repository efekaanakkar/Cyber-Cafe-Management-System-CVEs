# CVE-2025-70891 â€“ Stored Cross-Site Scripting (XSS)

## ğŸ“Œ Description
A stored cross-site scripting (XSS) vulnerability exists in Cyber Cafe Management System v1.0 affecting the uadd parameter in the add-users.php endpoint. An authenticated attacker with administrative privileges can inject malicious JavaScript payloads during the user creation process.

Due to insufficient input validation and output sanitization, the injected payload is stored persistently in the backend database. The stored malicious JavaScript is subsequently executed in the victimâ€™s browser when the affected user record is accessed via the view-user-detail.php?upid=<user_id> endpoint.

Successful exploitation allows attackers to execute arbitrary JavaScript in the context of the authenticated user, potentially leading to session hijacking, privilege escalation, or further compromise of the application.

## ğŸ§± Affected Product
- Product: Cyber Cafe Management System
- Vendor: PHPGurukul
- Version: v1.0

## ğŸ“‚ Affected Component
- File: `add-users.php`
- Parameter: `uadd`
- Request Method: POST

## ğŸ¯ Attack Vector
An authenticated attacker can exploit this vulnerability by submitting
crafted input containing malicious JavaScript code via the `uadd`
parameter during the user creation process in the `add-users.php`
endpoint.

## ğŸ” Vulnerability Type
Stored Cross-Site Scripting (XSS)

## âš ï¸ Impact
- Execution of arbitrary JavaScript code
- Information disclosure
- Potential session hijacking
- Unauthorized actions performed in the context of authenticated users

## ğŸ§ª Proof of Concept
The vulnerability was confirmed by injecting a crafted JavaScript payload into the uadd parameter during the user creation process. The malicious input is stored persistently in the backend database due to improper input sanitization.

When the affected user record is accessed via the view-user-detail.php?upid=<user_id> endpoint, the stored payload is rendered in the response and automatically executed in the victimâ€™s browser.

### Request Flow
The request responsible for storing the malicious input is sent as an
HTTP POST request to the `add-users.php` endpoint, where user-supplied
parameters are processed and stored without adequate input validation or
output encoding.

> ğŸ“· Screenshot evidence demonstrating the stored script execution will
> be added for reference.

## ğŸ›¡ Mitigation
- Validate and sanitize all user-supplied input on the server side
- Apply proper output encoding when rendering dynamic content
- Implement a strict Content Security Policy (CSP)
- Use secure input handling mechanisms and frameworks

## ğŸ”— References
- https://phpgurukul.com/cyber-cafe-management-system-using-php-mysql/
- https://phpgurukul.com/?sdm_process_download=1&download_id=21779

## ğŸ‘¤ Discoverer
Efe Kaan AKKAR


