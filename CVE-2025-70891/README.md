# CVE-2025-70891 â€“ Stored Cross-Site Scripting (XSS)

## ðŸ“Œ Description
A stored cross-site scripting (XSS) vulnerability exists in Cyber Cafe
Management System v1.0 affecting the `uadd` parameter in the
`add-users.php` endpoint. An authenticated attacker with administrative
privileges can exploit this vulnerability by submitting crafted input
containing malicious JavaScript code during the user creation process.
The application fails to properly sanitize user-supplied input before
storing it in the backend database, resulting in the persistent storage
of malicious JavaScript code that is later executed in the browser when
user records are viewed via the `view-allusers.php` endpoint.

## ðŸ§± Affected Product
- Product: Cyber Cafe Management System
- Vendor: PHPGurukul
- Version: v1.0

## ðŸ“‚ Affected Component
- File: `add-users.php`
- Parameter: `uadd`
- Request Method: POST

## ðŸŽ¯ Attack Vector
An authenticated attacker can exploit this vulnerability by submitting
crafted input containing malicious JavaScript code via the `uadd`
parameter during the user creation process in the `add-users.php`
endpoint.

## ðŸ” Vulnerability Type
Stored Cross-Site Scripting (XSS)

## âš ï¸ Impact
- Execution of arbitrary JavaScript code
- Information disclosure
- Potential session hijacking
- Unauthorized actions performed in the context of authenticated users

## ðŸ§ª Proof of Concept
The vulnerability was confirmed by injecting a JavaScript payload into
the `uadd` parameter during user creation. The malicious input is stored
in the backend database without proper sanitization.

When the list of users is accessed through the `view-allusers.php`
endpoint, the stored payload is rendered and executed automatically in
the victimâ€™s browser.

### Request Flow
The request responsible for storing the malicious input is sent as an
HTTP POST request to the `add-users.php` endpoint, where user-supplied
parameters are processed and stored without adequate input validation or
output encoding.

> ðŸ“· Screenshot evidence demonstrating the stored script execution will
> be added for reference.

## ðŸ›¡ Mitigation
- Validate and sanitize all user-supplied input on the server side
- Apply proper output encoding when rendering dynamic content
- Implement a strict Content Security Policy (CSP)
- Use secure input handling mechanisms and frameworks

## ðŸ”— References
- https://phpgurukul.com/cyber-cafe-management-system-using-php-mysql/
- https://phpgurukul.com/?sdm_process_download=1&download_id=21779

## ðŸ‘¤ Discoverer
Efe Kaan AKKAR
