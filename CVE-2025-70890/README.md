# CVE-2025-70890 â€“ Stored Cross-Site Scripting (XSS)

## ğŸ“Œ Description
An authenticated attacker with administrative privileges can exploit
this vulnerability by submitting crafted input containing malicious
JavaScript code via the `add-users.php` endpoint during the user creation
process. The application fails to properly sanitize user-supplied input
before storing it in the backend database, resulting in the persistent storage 
of malicious JavaScript code that is later executed in the browser of any user 
who accesses the affected page. The stored payload is triggered when 
viewing the user list via the `view-allusers.php` endpoint.



## ğŸ§± Affected Product
- Product: Cyber Cafe Management System
- Vendor: PHPGurukul
- Version: v1.0

## ğŸ“‚ Affected Component
- File: `add-users.php`
- Parameter: `username`
- Request Method: POST

## ğŸ¯ Attack Vector
An authenticated attacker can exploit this vulnerability by submitting
crafted input containing malicious JavaScript code via the
`add-users.php` endpoint during the user creation process.

## ğŸ” Vulnerability Type
Stored Cross-Site Scripting (XSS)

## âš ï¸ Impact
- Execution of arbitrary JavaScript code
- Information disclosure
- Potential session hijacking
- Unauthorized actions performed in the context of authenticated users

## ğŸ§ª Proof of Concept
The issue was validated by injecting a JavaScript payload into the
`username` parameter during user creation. The input is stored in the
database without proper sanitization.

When the list of users is accessed through the `view-allusers.php`
endpoint, the stored payload is rendered and executed automatically in
the victimâ€™s browser.

![XSS Poc](/images/CVE-2025-70890_XSS2.png)
------------------------------------------
![XSS Poc](/images/CVE-2025-70890_XSS.png)

### Request Flow
The request responsible for storing the malicious input is sent as an
HTTP POST request to the `add-users.php` endpoint, where user-supplied
parameters are processed and stored in the backend database without
adequate input validation or output encoding.


## ğŸ›¡ Mitigation
- Validate and sanitize all user-supplied input on the server side
- Apply proper output encoding when rendering dynamic content
- Implement a strict Content Security Policy (CSP)
- Use secure input handling mechanisms and frameworks

## ğŸ”— References
- https://phpgurukul.com/cyber-cafe-management-system-using-php-mysql/
- https://phpgurukul.com/?sdm_process_download=1&download_id=21779

## ğŸ‘¤ Discoverer
Efe Kaan AKKAR




